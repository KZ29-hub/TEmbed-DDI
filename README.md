# TEmbed-DDI
When East Meets West: cross-domain drug interaction annotations with large language models and bidirectional neural networks



Additional Small Experiments:

A. Performance analysis on different embedding fusion methods
We also conducted additional experiments to optimize our framework, including evaluating the impact of different embedding fusion methods and varying the ratio of positive to negative samples on the performance of TEmbed-DDI. For embedding fusion, We tested two approaches: (1) directly concatenating the embeddings of drug pairs. (2) utilizing a dot product-based attention mechanism (AM) to calculate attention scores and dynamically adjust weights for each drug pair based on contextual information.  As shown in Fig. 1, the concatenation method (C) significantly outperformed the attention mechanism, with the latter performing poorly. This discrepancy may be due to the concatenation method better preserving the original feature distribution of the data, whereas the simple attention mechanism may have focused on less critical information, leading to suboptimal leading outcomes. Next, we explored the impact of different positive-to-negative (pos-to-neg) sample ratios. The optimal configuration was achieved with a ratio of full positive samples, augmented negative samples, and non-relation samples of 2000 in C3 (P:2N:2000), resulting in an accuracy of 0.889, AUC of 0.956, and AUPR of 0.907. Notably, the statistical significance of the improvements for the optimal C3 configuration compared to the other combinations was evaluated. The C3 configuration demonstrated a significant performance advantage over the best attention mechanism and the second-ranked concatenation mechanism, with p-values of 3.6e-8 and 2.5e-4 for AUC, and 2.2e-5 and 1.7e-3 for AUPR. All p-values were well below the significance threshold of 0.05, confirming that the C3 configuration achieved a statistically significant improvement in interaction annotation performance. This configuration retained all positive and negative drug pairs, supplemented by data augmentation for negative samples, and constructed a non-relevant dataset by randomly replacing drugs in existing interaction data. To ensure no overlap between augmented data in the training set and original data in the test set, we first split the training and testing datasets before applying data augmentation and combination techniques. 


![image](https://github.com/KZ29-hub/TEmbed-DDI/blob/main/Img/fusion_experiment.jpg)
The bar chart explores the impact of different feature fusion methods and varying positive-to-negative-to-nonrelation sample ratios. The fusion methods include the Attention Mechanism Method (AM) and the Concatenation Method (C). The specific configurations analyzed are as follows: AM1 (P:N:1000), AM2 (P:N:2000), C1 (P:N:1000), C2 (P:N:2000), C3 (P:2N:2000), and C4 (2P:2N:4000). For example, AM1(P:N:1000) means full positive data, full negative data and non-relation data of 1000 samples.
